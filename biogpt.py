from transformers import AutoModelForCausalLM, AutoTokenizer, pipeline

from transformers import AutoTokenizer, AutoModelForCausalLM
import time
model_id = "meta-llama/Llama-3.2-1B"

token = "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"  # Your token from Hugging Face

start = time.time()
tokenizer = AutoTokenizer.from_pretrained(model_id, token=token)
model = AutoModelForCausalLM.from_pretrained(model_id, token=token)


generator = pipeline("text-generation", model=model, tokenizer=tokenizer)

# context = "acute myeloid leukemia treatment - nci skip to main content an official website of the united states government espanol menu search search about cancer cancer types research grants & training news & events about nci home cancer types leukemia patient acute myeloid leukemia treatment ( pdq® ) – patient version print email leukemia patient adult all treatment adult aml treatment cll treatment cml treatment hairy cell leukemia treatment childhood all treatment childhood aml treatment health professional research advances acute myeloid leukemia treatment ( pdq® ) – patient version on this page general information about acute myeloid leukemia stages of acute myeloid leukemia treatment option overview treatment of untreated acute myeloid leukemia treatment of acute myeloid leukemia in remission treatment of refractory or recurrent acute myeloid leukemia treatment of acute promyelocytic leukemia treatment of recurrent acute promyelocytic leukemia to learn more about leukemia about this pdq summary general information about acute myeloid leukemia go to health professional version key points adult acute myeloid leukemia ( aml ) is a type of cancer in which the bone marrow makes a large number of abnormal blood cells. leukemia may affect red blood cells, white blood cells, and platelets. there are different subtypes of aml. smoking, previous chemotherapy treatment, and exposure to radiation may increase the risk of aml. signs and symptoms of aml include fever, feeling tired, and easy bruising or bleeding. tests that examine the blood and bone marrow are used to diagnose aml. after aml has been diagnosed, tests are done to find out if the cancer has spread to other parts of the body. some people decide to get a second opinion. certain factors affect prognosis ( chance of recovery ) and treatment options. adult acute myeloid leukemia ( aml ) is a type of cancer in which the bone marrow makes a large number of abnormal blood cells. aml is a cancer of the blood and bone marrow. it is the most common type of acute leukemia in adults. this type of cancer usually gets worse quickly if it is not treated. aml is also called acute myelogenous leukemia and acute nonlymphocytic leukemia. enlarge anatomy of the bone. the bone is made up of compact bone, spongy bone, and bone marrow. compact bone makes up the outer layer of the bone. spongy bone is found mostly at the ends of bones and contains red marrow.  there are two types of bone marrow : red and yellow. red marrow contains blood stem cells that can become red blood cells, white blood cells, or platelets. yellow marrow is made mostly of fat. leukemia may affect red blood cells, white blood cells, and platelets. the bone marrow and thymus make blood stem cells ( immature cells ) that become mature blood cells over time. a blood stem cell may become a myeloid stem cell or a lymphoid stem cell. myeloid stem cells go through several stages of development in the bone marrow before fully maturing into : red blood cells that carry oxygen and other substances to all tissues of the body granulocytes and other types of white blood cells that help the body ’ s immune system respond to infection, allergens, and inflammation platelets that help stop bleeding by forming clots enlarge blood cell development. a blood stem cell goes through several steps to become a red blood cell, platelet, or white blood cell. in aml, there is an increase in the number of immature white blood cells called myeloblasts ( or myeloid blasts ). the myeloblasts in aml are abnormal and do not become healthy white blood cells. as the number of these cells, also called leukemia cells, increases in the blood and bone marrow, there is less room for healthy platelets, red blood cells, and other white blood cells. this may lead to easy bleeding, anemia, and infection. the leukemia cells can spread outside the blood to other parts of the body, including the central nervous system ( cns ; brain and spinal cord ), skin, and gums. sometimes leukemia cells form a solid tumor called a myeloid sarcoma. myeloid sarcoma is also called extramedullary myeloid tumor, granulocytic sarcoma, or chloroma. there are different subtypes of aml. most aml subtypes are based on how mature ( developed ) the cancer cells are at the time of diagnosis, and how different they are from normal cells. acute promyelocytic leukemia ( apl ) is a subtype of aml. this leukemia occurs when genes on chromosome 15 switch places with some genes on chromosome 17, and an abnormal gene called pml : : rara is made. the pml : : rara gene sends a message that stops promyelocytes ( a type of white blood cell ) cells. the leukemia cells can build up in the blood and bone marrow so there is less room for healthy white blood cells, red blood cells, and platelets. this may lead to infection, anemia, or easy bleeding. the leukemia cells can spread outside the blood to other parts of the body, including the central nervous system ( brain and spinal cord ), skin, and gums. sometimes leukemia cells form a solid tumor called a myeloid sarcoma. myeloid sarcoma is also called granulocytic sarcoma or chloroma. other myeloid diseases can affect the blood and bone marrow. transient abnormal myelopoiesis ( tam ) tam is a disorder of the bone marrow that can develop in newborns who have down syndrome. tam usually goes away on its own within the first 3 months of life. infants who have tam have an increased chance of developing aml before the age of 3 years. tam is also called transient myeloproliferative disorder or transient leukemia. acute promyelocytic leukemia ( apl ) apl is a subtype of aml. in apl, some genes on chromosome 15 switch places with some genes on chromosome 17 and an abnormal gene called pml - rara is made. the pml - rara gene sends a message that stops promyelocytes ( a type of white blood cell ) from maturing. the promyelocytes ( leukemia cells ) can build up in the blood and bone marrow so there is less room for healthy white blood cells, red blood cells, and platelets. problems with severe bleeding and blood clots may also occur. this is a serious health problem that needs treatment as soon as possible. juvenile myelomonocytic leukemia ( jmml ) jmml is a rare childhood cancer that is most common in children around the age of 2 years and is more common in boys. in jmml, too many myeloid blood stem cells become myelocytes and monocytes ( two types of white blood cells ). some of these myeloid blood stem cells never become mature white blood cells. these immature cells, called blasts, are unable to do their usual work. over time, the myelocytes, monocytes, and blasts crowd out the healthy white blood cells, red blood cells, and platelets in the bone marrow. when this happens, infection, anemia, or easy bleeding may occur. chronic myelogenous leukemia ( cml ) cml often begins in an"
question = "What is Adult Acute Myeloid Leukemia ?"
context = "- Adult acute myeloid leukemia (AML) is a type of cancer in which the bone marrow makes abnormal myeloblasts (a type of white blood cell), red blood cells, or platelets.     - Leukemia may affect red blood cells, white blood cells, and platelets.    - There are different subtypes of AML.     - Smoking, previous chemotherapy treatment, and exposure to radiation may affect the risk of adult AML.    - Signs and symptoms of adult AML include fever, feeling tired, and easy bruising or bleeding.    - Tests that examine the blood and bone marrow are used to detect (find) and diagnose adult AML.    - Certain factors affect prognosis (chance of recovery) and treatment options. Adult acute myeloid leukemia (AML) is a type of cancer in which the bone marrow makes abnormal myeloblasts (a type of white blood cell), red blood cells, or platelets. Adult acute myeloid leukemia (AML) is a cancer of the blood and bone marrow. This type of cancer usually gets worse quickly if it is not treated. It is the most common type of acute leukemia in adults. AML is also called acute myelogenous leukemia, acute myeloblastic leukemia, acute granulocytic leukemia, and acute nonlymphocytic leukemia. Leukemia may affect red blood cells, white blood cells, and platelets. Normally, the bone marrow makes blood stem cells (immature cells) that become mature blood cells over time. A blood stem cell may become a myeloid stem cell or a lymphoid stem cell. A lymphoid stem cell becomes a white blood cell.    A myeloid stem cell becomes one of three types of mature blood cells:         -  Red blood cells that carry oxygen and other substances to all tissues of the body.    - White blood cells that fight infection and disease.    -  Platelets that form blood clots to stop bleeding.         In AML, the myeloid stem cells usually become a type of immature white blood cell called myeloblasts (or myeloid blasts). The myeloblasts in AML are abnormal and do not become healthy white blood cells. Sometimes in AML, too many stem cells become abnormal red blood cells or platelets. These abnormal white blood cells, red blood cells, or platelets are also called leukemia cells or blasts. Leukemia cells can build up in the bone marrow and blood so there is less room for healthy white blood cells, red blood cells, and platelets. When this happens, infection, anemia, or easy bleeding may occur. The leukemia cells can spread outside the blood to other parts of the body, including the central nervous system (brain and spinal cord), skin, and gums.   This summary is about adult AML. See the following PDQ summaries for information about other types of leukemia:         -  Childhood Acute Myeloid Leukemia/Other Myeloid Malignancies Treatment     -  Chronic Myelogenous Leukemia Treatment     -  Adult Acute Lymphoblastic Leukemia Treatment     -  Childhood Acute Lymphoblastic Leukemia Treatment     -  Chronic Lymphocytic Leukemia Treatment     -  Hairy Cell Leukemia Treatment There are different subtypes of AML.                    Most AML subtypes are based on how mature (developed) the cancer cells are at the time of diagnosis and how different they are from normal cells.     Acute promyelocytic leukemia (APL) is a subtype of AML that occurs when parts of two genes stick together. APL usually occurs in middle-aged adults. Signs of APL may include both bleeding and forming blood clots."

prompt = (
    f"Answer the following medical question in detail.\n\n"
    f"Context:\n{context}\n\n"
    f"Question:\n{question}\n\n"
    f"Answer:")

response = generator(prompt, max_new_tokens=256, temperature=0.7, do_sample=True)

print(response[0]["generated_text"])
end = time.time()
print("Time taken:", end - start)


